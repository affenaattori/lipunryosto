<!doctype html>
<html lang="fi">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Lipunry√∂st√∂ ‚Äî Admin: Lippupisteet</title>
  <meta name="theme-color" content="#0f172a">
  <style>
    :root{--bg:#0f172a;--card:#111827;--muted:#9ca3af;--line:#1f2937;--accent:#60a5fa}
    *{box-sizing:border-box}html,body{margin:0;background:#0f172a;color:#e5e7eb;font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif}
    .wrap{max-width:1200px;margin:0 auto;padding:16px}
    h1{font-size:22px;margin:8px 0 16px}
    .card{background:#111827;border:1px solid var(--line);border-radius:12px;padding:12px;margin-bottom:12px}
    label{display:block;font-size:12px;color:#9ca3af;margin:6px 0 4px}
    input,select{width:100%;padding:10px;border-radius:8px;border:1px solid #374151;background:#0b1220;color:#e5e7eb}
    button{padding:10px 12px;border:0;border-radius:10px;background:var(--accent);color:#0f172a;font-weight:700;cursor:pointer}
    button.secondary{background:#374151;color:#e5e7eb}
    .row{display:flex;gap:8px;flex-wrap:wrap}
    .row > *{flex:1}
    table{width:100%;border-collapse:separate;border-spacing:0 8px}
    th{font-size:12px;color:#9ca3af;text-align:left;padding:6px 8px}
    td{background:#0b1220;border:1px solid var(--line);padding:8px;border-radius:8px;vertical-align:top}
    .actions{display:flex;gap:8px;flex-wrap:wrap}
    .muted{color:#9ca3af}
    .small{font-size:12px}
    .grid-4{display:grid;grid-template-columns:repeat(4,1fr);gap:8px}
    canvas{max-width:100%;height:auto;background:#000;border-radius:10px;border:1px solid var(--line)}
    .map-wrap{position:relative}
    .hint{font-size:12px;color:#9ca3af;margin-top:6px}
    .badge{display:inline-block;padding:4px 8px;border-radius:9999px;background:#1f2937;color:#9ca3af;font-size:12px}
  </style>
</head>
<body>
<div class="wrap">
  <h1>üõ†Ô∏è Lipunry√∂st√∂ ‚Äî Admin: Lippupisteet</h1>

  <div class="card">
    <div class="row">
      <div><label>API-osoite</label><input id="apiBase" placeholder="https://lipunryosto-api.azurewebsites.net"></div>
      <div><label>Peli ID (GUID)</label><input id="gameId" placeholder="..."></div>
    </div>
    <div class="row" style="align-items:center;justify-content:space-between;margin-top:8px">
      <div class="actions">
        <button id="saveCfgBtn" class="secondary">Tallenna asetukset</button>
        <button id="loadBtn">Lataa lippupisteet</button>
      </div>
      <div class="actions">
        <button id="addFlagBtn">Lis√§√§ lippupiste (lomakkeesta)</button>
        <button id="normalizeBtn" class="secondary">Normalisoi nimet (A, B, C‚Ä¶)</button>
      </div>
    </div>
    <div id="info" class="muted small" style="margin-top:6px"></div>
  </div>

  <div class="card">
    <h3>Kartta (staattinen kuva)</h3>
    <div class="row">
      <div><label>Kuvan URL (esim. /admin-flags/map.png)</label><input id="mapUrl" placeholder="/admin-flags/map.png"></div>
    </div>
    <div class="grid-4">
      <div><label>Pohjoinen (maxLat)</label><input id="north"></div>
      <div><label>Etel√§ (minLat)</label><input id="south"></div>
      <div><label>L√§nsi (minLon)</label><input id="west"></div>
      <div><label>It√§ (maxLon)</label><input id="east"></div>
    </div>
    <div class="row" style="margin-top:8px">
      <div class="actions">
        <button id="loadMapBtn">Lataa kartta</button>
        <button id="saveMapCfgBtn" class="secondary">Tallenna kartta-asetukset</button>
      </div>
      <div><span id="cursorLatLon" class="badge">Lat,Lon: ‚Äì</span></div>
    </div>
    <div class="map-wrap" style="margin-top:8px">
      <canvas id="mapCanvas"></canvas>
    </div>
    <div class="hint">Aseta kuvan rajat (maxLat/minLat/minLon/maxLon). Klikkaa karttaa ‚Üí Lat/Lon t√§yttyv√§t alla. Voit my√∂s k√§ytt√§√§ GPS:√§√§.</div>
  </div>

  <div class="card">
    <h3>Uusi lippu</h3>
    <div class="grid-4">
      <div><label>Lat</label><input id="newLat"></div>
      <div><label>Lon</label><input id="newLon"></div>
      <div><label>Pisteet</label><input id="newPoints" type="number" value="10"></div>
      <div><label>V√§ri</label><input id="newColor" placeholder="blue"></div>
    </div>
    <div class="row" style="margin-top:8px">
      <button id="useMyGpsBtn" class="secondary">T√§yt√§ sijainti omasta GPS:st√§</button>
      <button id="createHereBtn">Lis√§√§ lippu nykyiseen sijaintiin</button>
    </div>
    <div class="muted small">GPS vaatii HTTPS-yhteyden ja sijaintiluvan selaimessa.</div>
  </div>

  <div class="card">
    <h3>Lippupisteet</h3>
    <table>
      <thead>
        <tr>
          <th>Valinta</th>
          <th>Nimi</th>
          <th>Lat</th>
          <th>Lon</th>
          <th>Pisteet</th>
          <th>V√§ri</th>
          <th>Status</th>
          <th>Toiminnot</th>
        </tr>
      </thead>
      <tbody id="flagsTbody"></tbody>
    </table>
    <div id="empty" class="muted">Ei lippuja viel√§.</div>

    <div class="row" style="margin-top:8px">
      <button id="updateSelectedPosBtn" class="secondary">P√§ivit√§ valitun lipun sijainti (viimeisin karttaklikkaus tai GPS)</button>
      <button id="focusSelectedBtn" class="secondary">N√§yt√§ valitun lipun sijainti kartalla</button>
    </div>
  </div>
</div>

<script src="flags-map-gps.js"></script>
</body>
</html>
